import{r as o}from"./index-BKyFwriW.js";import{c as j,u as q}from"./index-BRw1A0gZ.js";import{u as G}from"./index-C66SyY0f.js";import{c as fe}from"./index-CKTwuSvb.js";import{P as S}from"./index-BwBOz17u.js";import{j as h}from"./jsx-runtime-D_zvdyIk.js";var ve="Label",W=o.forwardRef((e,r)=>h.jsx(S.label,{...e,ref:r,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));W.displayName=ve;var[H,De]=fe("Form"),K="Form",[he,V]=H(K),[Ce,X]=H(K),Z=o.forwardRef((e,r)=>{const{__scopeForm:t,onClearServerErrors:i=()=>{},...a}=e,c=o.useRef(null),f=G(r,c),[d,v]=o.useState({}),u=o.useCallback(s=>d[s],[d]),p=o.useCallback((s,m)=>v(l=>({...l,[s]:{...l[s]??{},...m}})),[]),x=o.useCallback(s=>{v(m=>({...m,[s]:void 0})),n(m=>({...m,[s]:{}}))},[]),[C,y]=o.useState({}),I=o.useCallback(s=>C[s]??[],[C]),M=o.useCallback((s,m)=>{y(l=>({...l,[s]:[...l[s]??[],m]}))},[]),g=o.useCallback((s,m)=>{y(l=>({...l,[s]:(l[s]??[]).filter(E=>E.id!==m)}))},[]),[A,n]=o.useState({}),F=o.useCallback(s=>A[s]??{},[A]),b=o.useCallback((s,m)=>{n(l=>({...l,[s]:{...l[s]??{},...m}}))},[]),[R,_]=o.useState({}),N=o.useCallback((s,m)=>{_(l=>{const E=new Set(l[s]).add(m);return{...l,[s]:E}})},[]),T=o.useCallback((s,m)=>{_(l=>{const E=new Set(l[s]);return E.delete(m),{...l,[s]:E}})},[]),D=o.useCallback(s=>Array.from(R[s]??[]).join(" ")||void 0,[R]);return h.jsx(he,{scope:t,getFieldValidity:u,onFieldValidityChange:p,getFieldCustomMatcherEntries:I,onFieldCustomMatcherEntryAdd:M,onFieldCustomMatcherEntryRemove:g,getFieldCustomErrors:F,onFieldCustomErrorsChange:b,onFieldValiditionClear:x,children:h.jsx(Ce,{scope:t,onFieldMessageIdAdd:N,onFieldMessageIdRemove:T,getFieldDescription:D,children:h.jsx(S.form,{...a,ref:f,onInvalid:j(e.onInvalid,s=>{const m=ae(s.currentTarget);m===s.target&&m.focus(),s.preventDefault()}),onSubmit:j(e.onSubmit,i,{checkForDefaultPrevented:!1}),onReset:j(e.onReset,i)})})})});Z.displayName=K;var Y="FormField",[Fe,w]=H(Y),ee=o.forwardRef((e,r)=>{const{__scopeForm:t,name:i,serverInvalid:a=!1,...c}=e,d=V(Y,t).getFieldValidity(i),v=q();return h.jsx(Fe,{scope:t,id:v,name:i,serverInvalid:a,children:h.jsx(S.div,{"data-valid":z(d,a),"data-invalid":J(d,a),...c,ref:r})})});ee.displayName=Y;var O="FormLabel",te=o.forwardRef((e,r)=>{const{__scopeForm:t,...i}=e,a=V(O,t),c=w(O,t),f=i.htmlFor||c.id,d=a.getFieldValidity(c.name);return h.jsx(W,{"data-valid":z(d,c.serverInvalid),"data-invalid":J(d,c.serverInvalid),...i,ref:r,htmlFor:f})});te.displayName=O;var k="FormControl",re=o.forwardRef((e,r)=>{const{__scopeForm:t,...i}=e,a=V(k,t),c=w(k,t),f=X(k,t),d=o.useRef(null),v=G(r,d),u=i.name||c.name,p=i.id||c.id,x=a.getFieldCustomMatcherEntries(u),{onFieldValidityChange:C,onFieldCustomErrorsChange:y,onFieldValiditionClear:I}=a,M=o.useCallback(async n=>{if(ie(n.validity)){const l=B(n.validity);C(u,l);return}const F=n.form?new FormData(n.form):new FormData,b=[n.value,F],R=[],_=[];x.forEach(l=>{xe(l,b)?_.push(l):Ae(l)&&R.push(l)});const N=R.map(({id:l,match:E})=>[l,E(...b)]),T=Object.fromEntries(N),D=Object.values(T).some(Boolean),s=D;n.setCustomValidity(s?P:"");const m=B(n.validity);if(C(u,m),y(u,T),!D&&_.length>0){const l=_.map(({id:de,match:ue})=>ue(...b).then(me=>[de,me])),E=await Promise.all(l),Q=Object.fromEntries(E),le=Object.values(Q).some(Boolean);n.setCustomValidity(le?P:"");const ce=B(n.validity);C(u,ce),y(u,Q)}},[x,u,y,C]);o.useEffect(()=>{const n=d.current;if(n){const F=()=>M(n);return n.addEventListener("change",F),()=>n.removeEventListener("change",F)}},[M]);const g=o.useCallback(()=>{const n=d.current;n&&(n.setCustomValidity(""),I(u))},[u,I]);o.useEffect(()=>{const n=d.current?.form;if(n)return n.addEventListener("reset",g),()=>n.removeEventListener("reset",g)},[g]),o.useEffect(()=>{const n=d.current,F=n?.closest("form");if(F&&c.serverInvalid){const b=ae(F);b===n&&b.focus()}},[c.serverInvalid]);const A=a.getFieldValidity(u);return h.jsx(S.input,{"data-valid":z(A,c.serverInvalid),"data-invalid":J(A,c.serverInvalid),"aria-invalid":c.serverInvalid?!0:void 0,"aria-describedby":f.getFieldDescription(u),title:"",...i,ref:v,id:p,name:u,onInvalid:j(e.onInvalid,n=>{const F=n.currentTarget;M(F)}),onChange:j(e.onChange,n=>{g()})})});re.displayName=k;var P="This value is not valid",ye={badInput:P,patternMismatch:"This value does not match the required pattern",rangeOverflow:"This value is too large",rangeUnderflow:"This value is too small",stepMismatch:"This value does not match the required step",tooLong:"This value is too long",tooShort:"This value is too short",typeMismatch:"This value does not match the required type",valid:void 0,valueMissing:"This value is missing"},L="FormMessage",oe=o.forwardRef((e,r)=>{const{match:t,name:i,...a}=e,c=w(L,e.__scopeForm),f=i??c.name;return t===void 0?h.jsx($,{...a,ref:r,name:f,children:e.children||P}):typeof t=="function"?h.jsx(ge,{match:t,...a,ref:r,name:f}):h.jsx(Ee,{match:t,...a,ref:r,name:f})});oe.displayName=L;var Ee=o.forwardRef((e,r)=>{const{match:t,forceMatch:i=!1,name:a,children:c,...f}=e,v=V(L,f.__scopeForm).getFieldValidity(a);return i||v?.[t]?h.jsx($,{ref:r,...f,name:a,children:c??ye[t]}):null}),ge=o.forwardRef((e,r)=>{const{match:t,forceMatch:i=!1,name:a,id:c,children:f,...d}=e,v=V(L,d.__scopeForm),u=o.useRef(null),p=G(r,u),x=q(),C=c??x,y=o.useMemo(()=>({id:C,match:t}),[C,t]),{onFieldCustomMatcherEntryAdd:I,onFieldCustomMatcherEntryRemove:M}=v;o.useEffect(()=>(I(a,y),()=>M(a,y.id)),[y,a,I,M]);const g=v.getFieldValidity(a),n=v.getFieldCustomErrors(a)[C];return i||g&&!ie(g)&&n?h.jsx($,{id:C,ref:p,...d,name:a,children:f??P}):null}),$=o.forwardRef((e,r)=>{const{__scopeForm:t,id:i,name:a,...c}=e,f=X(L,t),d=q(),v=i??d,{onFieldMessageIdAdd:u,onFieldMessageIdRemove:p}=f;return o.useEffect(()=>(u(a,v),()=>p(a,v)),[a,v,u,p]),h.jsx(S.span,{id:v,...c,ref:r})}),U="FormValidityState",se=e=>{const{__scopeForm:r,name:t,children:i}=e,a=V(U,r),c=w(U,r),f=t??c.name,d=a.getFieldValidity(f);return h.jsx(h.Fragment,{children:i(d)})};se.displayName=U;var pe="FormSubmit",ne=o.forwardRef((e,r)=>{const{__scopeForm:t,...i}=e;return h.jsx(S.button,{type:"submit",...i,ref:r})});ne.displayName=pe;function B(e){const r={};for(const t in e)r[t]=e[t];return r}function Me(e){return e instanceof HTMLElement}function be(e){return"validity"in e}function Ie(e){return be(e)&&(e.validity.valid===!1||e.getAttribute("aria-invalid")==="true")}function ae(e){const r=e.elements,[t]=Array.from(r).filter(Me).filter(Ie);return t}function xe(e,r){return e.match.constructor.name==="AsyncFunction"||_e(e.match,r)}function Ae(e){return e.match.constructor.name==="Function"}function _e(e,r){return e(...r)instanceof Promise}function ie(e){let r=!1;for(const t in e){const i=t;if(i!=="valid"&&i!=="customError"&&e[i]){r=!0;break}}return r}function z(e,r){if(e?.valid===!0&&!r)return!0}function J(e,r){if(e?.valid===!1||r)return!0}var ke=Z,we=ee,Ne=te,Be=re,Oe=oe,Ue=se,qe=ne;export{Be as C,we as F,Ne as L,Oe as M,ke as R,qe as S,Ue as V,Z as a};
